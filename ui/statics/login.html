<!DOCTYPE html>

<html>
	<head>
		<title>device monitor</title>
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<link rel="stylesheet" href="./jquery/jquery-ui-1.12.1/jquery-ui.css" />
		<script src="./jquery/jquery-3.1.1.min.js"></script>
		<script src="./jquery/jquery-ui-1.12.1/jquery-ui.js"></script>
		<!-- Login Page Script -->
		<script>
			$( function(){
				function getform( t ){
					var $form = $( t );
					var user = $form.find( "input[name='username']" ).val();
					var pass = $form.find( "input[name='password']" ).val();
					if( user.length < 4 ){
						alert( "ユーザー名が入力されていません." );
						return false;
					}
					if( pass.length < 8 ){
						alert( "パスワードが入力されていないか短すぎます." );
						return false;
					}
					return { User: user, Pass: pass };
				}
				function httpfail(){
					alert( "HTTP Request Failed." );
				}
				$( "#main" ).tabs();
				$( "#login" ).submit( function( event ){
					event.preventDefault();
					var data = getform( this );
					if( data == false ) return;
					$.post( $(this).attr("action"), data,
						function( data ) {
							if( data["Stat"] == "OK" ) $( location ).attr( "href", "/dashbord" );
							else alert( "Login Failed" );
						}, "json"
					).fail( httpfail );
				});
				$( "#signup" ).submit( function( event ){
					event.preventDefault();
					var data = getform( this );
					if( data == false ) return;
					$.post( $(this).attr("action"), data,
						function( data ) {
							if( data["Stat"] == "OK" ) alert( "User Created" );
							else alert( "User exist" );
						}, "json"
					).fail( httpfail );
				});
			});
		</script>
		<!-- end -->
		<!-- Login Page Style Sheet -->
		<style>
			body {
				line-height: 2em;
			}
			#main {
				width:50%;
				min-width:300px;
				margin: auto;
			}
		</style>
		<!-- end -->
	</head>
	<body>
		<div id="main">
			<ul>
				<li><a href="#login">Login</a></li>
				<li><a href="#signup">Sign Up</a></li>
			</ul>
			<div>
				<form action="/api/login" id="login">
					User:<input name="username" /><br />
					Pass:<input type="password" name="password" /><br />
					<input type="submit" value="Login" />
				</form>
			</div>
			<div action="/api/signup" id="signup" >
				<form id="signup">
					User:<input name="username" /><br />
					Pass:<input type="password" name="password" /><br />
					<input type="submit" value="Sign Up" />
				</form>
			</div>
		</div>
	</body>
</html>

